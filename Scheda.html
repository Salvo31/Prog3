<html>

<head>
<meta charset="utf-8">
<link rel="stylesheet" href="Css/cssTemporanei.css">
<title> Scheda </title>
</head>

<body>

  <div id="descrizione">
    <h2> <strong> Scheda </strong> </h2> <br>
    Con questa opzione potrai generare una classica scheda di allenamento con serie e ripetizioni ben definite <br>
    Proprio come quelle che si utilizzano in sala attrezzi! Con la differenza che qui ti dovrai affidare al caso...
  </div> <br> <br>

  <div id="pannelloWorkout"> </div> <br>
  <button id="start"> Start workout </button> <br>

  <div id="opzioniAllenamento">
    Vuoi selezionare un focus di gruppi muscolari per l'allenamento di oggi?
    <input type="checkbox" id="checkGruppi"> <br>

    <div id="selezioneGruppi" class="invisibles">
      <div id="gruppi">

      </div>
    </div>

  </div>

  <script src="ExternalJs/listaGruppi.js">

    window.onload = bindEvents;
    var placeholder = document.getElementById("gruppi");
    var gruppiScelti = new listaGruppi();
    function bindEvents(){
      document.getElementById("checkGruppi").addEventListener("change",setGruppiMuscolari);
      placeholder.addEventListener("change",blockSelection);
    }

    function blockSelection(){
      if(gruppiScelti.count == 3){
        alert("Non puoi scegliere pi√π di 3 gruppi muscolari!");
      }
      else{
        var childrens = placeholder.children;
        for(var i=0;i<childrens.length;i++){
          if(childrens[i].checked){
            gruppiScelti.scelte.addElement(childrens[i].value);
          }
          else if (!childrens[i].checked) {
            gruppiScelti.scelte.removeElement(childrens[i].value);
          }
        }
      }
      gruppiScelti.printList();
    }

    function setGruppiMuscolari(){
      if(document.getElementById("checkGruppi").checked){
        document.getElementsByClassName("invisibles")[0].style.display = "block";
        richiestaGruppiMuscolari();
      }
      else if (!document.getElementById("checkGruppi").checked) {
        document.getElementsByClassName("invisibles")[0].style.display = "none";
        placeholder.innerHTML = " ";
      }
    }

    function generaLista(gruppi){
      var i = 0;

      for(var i=0;i<gruppi.length;i++){ //genero dinamicamente una serie di checkbox per i gruppi muscolari
        var checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.id = i;
        placeholder.innerHTML += gruppi[i].Nome;
        checkbox.value = gruppi[i].IdGruppoMuscolare;
        placeholder.appendChild(checkbox);
        placeholder.innerHTML += "<br>";
      }
    }

    function richiestaGruppiMuscolari(){
      var ajax = new XMLHttpRequest();
      ajax.onreadystatechange = function(){
        if(ajax.readyState == 4){
          var gruppi = JSON.parse(ajax.responseText);
          generaLista(gruppi);
        }
      };
      ajax.open("GET","apiDb.php/gruppomuscolare",true);
      ajax.send(null);
    }

  </script>

</body>

</html>
